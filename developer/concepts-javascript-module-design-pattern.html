---
title: 'Le modèle de conception du module JavaScript'
parent: Developers
---

<article class="bcls-article">
  <h1>Concepts : Le modèle de conception du module JavaScript</h1>
  <summary>Dans cette rubrique, vous apprendrez comment utiliser le modèle de conception de module JavaScript pour réduire le risque que votre code soit en conflit avec d'autres scripts de votre page Web.</summary>
  <section class="bcls-section">
    <h2 id="Scope_conflicts">Conflits d'étendue</h2>
    <p>En JavaScript, lorsque vous définissez une variable à l'aide de l' <code translate="No">var</code> élément, elle est étendue dans la fonction qu'elle est définie. Si vous définissez une variable sans utiliser <code translate="No">var</code>, elle est affectée à l'étendue globale. Cela signifie que les variables globales sont vulnérables aux collisions avec d'autres scripts de votre page.</p>
    <p>Regardons un exemple de code. Dans le code suivant, la fonction et les variables existent dans la portée de la page.</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// script 1
var incrementCount = function() {
    count++;
}

var myButton = document.getElementById('buttonId');
var count = 0;

myButton.onclick = incrementCount;</code></pre>
    <p>Maintenant, disons qu'il existe une fonction en dehors de votre script qui modifie également la <code translate="No">count</code> variable globale. Cette collision de scripts peut provoquer des résultats inattendus.</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">// script 2
var countVideos = function(videoList) {
    count = videoList.length;
}</code></pre>
    <p>Résultats :</p>
    <ol>
      <li>L'utilisateur sélectionne le <code translate="No">myButton</code> bouton deux fois, en incrémentant la <code translate="No">count</code> variable dans <code translate="No">script 1</code>.
        <ul>
          <li><code translate="No">count</code> = <strong>2</strong></li>
        </ul>
      </li>
      <li>La <code translate="No">countvideos</code> fonction est appelée qui existe dans <code translate="No">Script 2</code>, mais aussi sur votre page Web. Disons que le <code translate="No">videoList</code> contient 10 éléments. Maintenant, la variable <code translate="No">count</code> globale a une valeur de <strong>10</strong>.
        <ul>
          <li><code translate="No">count</code> = <strong>10</strong></li>
        </ul>
      </li>
      <li>La prochaine fois que l'utilisateur sélectionne le <code translate="No">myButton</code> bouton, la <code translate="No">count</code> variable renvoie des résultats inattendus.
        <ul>
          <li>Prévisible : <code translate="No">count</code> = <strong>3</strong></li>
          <li>Réel : <code translate="No">count</code> = <strong>11</strong></li>
        </ul>
      </li>
    </ol>
    <p>Vous pouvez essayer d'éviter les conflits dans vos scripts, mais il n'y a aucune garantie que les scripts tiers inclus dans votre page n'utiliseront pas des noms de fonction et de variables similaires.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Anonymous_functions">Fonctions anonymes</h2>
    <p>Une solution consiste à envelopper votre code dans une fonction anonyme (également appelée fermeture), qui est exécutée immédiatement. Votre code dans une fermeture n'est pas accessible par d'autres scripts. Donc, cela vous donne un moyen de créer des fonctions et des variables privées.</p>
    <p>Voici la syntaxe d'une fonction anonyme :</p>
    <ul>
      <li>Ligne 3 : inclut un ensemble supplémentaire de parenthèses, qui indique à JavaScript d'exécuter la fonction immédiatement après qu'elle a été analysée, au lieu d'attendre qu'un autre code appelle la fonction.</li>
    </ul>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">(function () {
    // your code
}<span class="bcls-highlight">()</span>);</code></pre>
    <p>Les fermetures peuvent être puissantes, car elles assurent la confidentialité et l'état tout au long de la durée de vie de l'application. Pour le code à l'intérieur de la fermeture, toutes les variables et fonctions sont dans la portée de fermeture uniquement. Mais, votre code à l'intérieur de la fermeture peut toujours accéder à toutes les variables ou fonctions globales.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Globals">Globals</h2>
    <p>Bien que JavaScript ait une fonctionnalité connue sous le nom de globaux implicites, il peut rendre votre code difficile à gérer, car il n'est pas facile de déterminer quelles variables sont globales. Pour déterminer si une variable est globale, l'interpréteur doit revenir à travers la chaîne de portée à la recherche d'une <code translate="No">var</code> instruction qui correspond au nom. Si aucun n'est trouvé, la variable est supposée être globale.</p>
    <h3>Passer dans les globaux</h3>
    <p>Avec la fonction anonyme, vous pouvez explicitement passer des paramètres globaux. C'est ce qu'on appelle l'importation de paramètres dans votre code.</p>
    <p>Voici un exemple :</p>
    <ul>
      <li>Ligne 1 : définit le nom des paramètres passés dans la fonction. Notez qu'ils n'ont pas à correspondre aux noms de la ligne 3. Ici, l' <code translate="No">window</code> objet est passé dans un paramètre nommé <code translate="No">window1</code>.</li>
      <li>Ligne 3 : passe l' <code translate="No">window</code> objet dans la fonction.</li>
    </ul>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">(function( window1, undefined ) {
    ...
})(window);</code></pre>
    <p>Puisqu'il n'y a qu'un seul objet transmis, mais qu'il existe deux paramètres, la valeur de ne <code translate="No">undefined</code> sera pas définie.</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">typeof undefined == "undefined"</code></pre>
    <p>Cela peut être pratique si vous voulez un moyen facile de vérifier si d'autres variables sont définies.</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">if(variable1 === undefined)</code></pre>
    <h3>Exporter des globaux</h3>
    <p>Vous pouvez également passer des variables et des fonctions en dehors de votre fonction anonyme. Vous pouvez le faire en utilisant la <code translate="No">return</code> valeur.</p>
    <p>Voici un exemple :</p>
    <ul>
      <li>Ligne 1 : assigne notre fonction anonyme à <code translate="No">BCLS</code>. Cette valeur peut être tout ce que vous choisissez. Dans cet exemple, nous utilisons BCLS (Brightcove Learning Services).</li>
    </ul>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">var BCLS = (function( window1, undefined ) {
    var object1 = {};
    object1.count = 1;
    object1.method = function () {
        ...
    }
    <span class="bcls-highlight">return object1;</span>
})(window);</code></pre>
    <p>L' <code translate="No">object1</code> objet est maintenant disponible globalement avec deux propriétés publiques, une variable nommée <code translate="No">count</code> et une fonction nommée <code translate="No">method</code>. Ils sont accessibles en dehors de notre fonction anonyme comme :</p>
    <ul>
      <li><code translate="No">BCLS.object1.count</code></li>
      <li><code translate="No">BCLS.object1.method</code></li>
    </ul>
  </section>
  <section class="bcls-section">
    <h2 id="Complete_example">Exemples complets</h2>
    <p>Voici quelques exemples complets du modèle de conception du module JavaScript.</p>
    <h3>Exemple 1</h3>
    <p>Cet exemple montre comment créer des variables et des fonctions privées et publiques à l'aide du modèle de module.</p>
    <ul>
      <li>Variables privées : <code translate="No">myvar</code>, <code translate="No">myvar2</code></li>
      <li>Fonctions privées : <code translate="No">fname</code>, <code translate="No">fname2</code></li>
      <li>Variable publique : <code translate="No">myvar3</code></li>
      <li>Fonction publique : <code translate="No">fname3</code></li>
    </ul>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">var BCLS = ( function() {
   var myvar = value,
       myvar2 = value;

   fname = function() {
        ...
   };
   fname2 = function() {
        ...
   };

   return {
        fname3 : function() {
             ...
        },
        myvar3 = value;
   };
}());</code></pre>
    <h3>Exemple 2</h3>
    <p>Cet exemple transmet des objets globaux et expose une fonction publique.</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">var BCLS = (function( window, document, videojs ) {
    var myvar = value;

    // use a global object passed into the anonymous function
    videojs.registerPlugin('overlay');

    fname = function() {
        ...
    }
    return {
      fname2 : function() {
            ...
        }
    }
})(window, document, videojs);

// call the public function fname2
var newvar = BCLS.fname2();</code></pre>
  </section>
  <section class="bcls-section">
    <h2 id="Code_samples">Des échantillons de code</h2>
    <p>Certains de nos exemples de code utilisent le modèle de conception de module JavaScript, et vous pouvez les examiner pour trouver des idées sur la façon d'implémenter ce modèle.</p>
    <ul>
      <li><a href="https://player.support.brightcove.com/code-samples/brightcove-player-sample-floating-player.html">Joueur flottant</a></li>
    </ul>
  </section>
</article>