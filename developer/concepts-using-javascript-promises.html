---
title: 'Utiliser les promesses JavaScript'
parent: Developers
---

<article class="bcls-article">
  <h1>Concepts : Utilisation des promesses JavaScript</h1>
  <summary>Dans cette rubrique, vous apprendrez comment utiliser les promesses JavaScript, qui sont renvoyées par certaines méthodes Brightcove Player.</summary>
  <section class="bcls-section">
    <h2 id="section-name2">Promesse simple</h2>
    <!-- <aside class="bcls-aside bcls-aside--information">Note: <strong translate="No">Promises</strong> do not work in IE11. Use the polyfill of the <a translate="No" href="https://www.npmjs.com/package/es6-promise">ES6-Promise</a> to add this functionality to IE11.</aside> -->
    <p>Bien que ce n'est pas le but de ce document de vous apprendre à écrire un JavaScript <code translate="No">Promise</code>, pour comprendre comment les utiliser, il est instructif de voir comment un simple <code translate="No">Promise</code> est codé.</p>
    <p>Dans ce qui suit, un <code translate="No">Promise</code> est créé qui renvoie une chaîne indiquant si une tâche a été terminée ou non. Le point clé est que soit le <code translate="No">Promise.resolve()</code> ou <code translate="No">Promise.reject()</code> méthode est appelée. Dans ce cas, une chaîne simple est passée par les deux méthodes, mais cela pourrait être un objet.</p>
    <aside class="bcls-aside bcls-aside--information">Note : Bien qu'il ne soit PAS démontré dans cet exemple simple, l' <code translate="No">Promise</code> <strong>objet représente la fin</strong> (ou l'échec) d'une opération <strong>asynchrone</strong>, et la valeur qui en résulte. De cette façon, un concept <code translate="No">Promise</code> est similaire à une fonction de rappel.</aside>
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">let promiseToFinishTask = new Promise(function(resolve, reject) {
          
            //Business logic to set taskComplete boolean
            let taskComplete = true;
          
            if (taskComplete) {
              resolve('Yea, I am done');
            } else {
              reject('Not quite done');
            }
          });</code></pre>
    <p>Maintenant, vous verrez comment traiter les <code translate="No">Promise</code> informations retournées, ce qui est ce que vous allez faire avec certains appels de méthode API Brightcove Player. La manipulation de base d'un suivant :</p>
    suit :
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">promiseName.then(
            // Function call for promise resolved
          ).catch(
            // Function call for promise rejected
          )</code></pre>
    <p>La manipulation de l'exemple simple ci-dessus apparaîtrait comme indiqué ici :</p>
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">promiseToFinishTask.then(function(fromResolve) {
            console.log(fromResolve);
          }).catch(function(fromReject) {
            console.log(fromReject);
          });</code></pre>
    <p>Si le <code translate="No">Promise</code> est résolu, le <code translate="No">then</code> code est exécuté, et si le <code translate="No">Promise</code> est rejeté, le <code translate="No">catch</code> code est exécuté. Pour l'exemple, l'une des chaînes <strong translate="No">Ouais, j'ai fini</strong> ou <strong translate="No">Pas tout à fait terminé</strong> apparaîtrait en fonction de la logique métier qui a défini le <code translate="No">taskComplete</code> valeur de la variable.</p>
  </section>
  <section class="bcls-section">
    <h2 id="section-name3">Exemple Brightcove</h2>
    <p>La <code translate="No">play()</code> méthode du lecteur Brightcove peut renvoyer une promesse qui peut être utilisée pour vérifier si le lecteur peut lire automatiquement la vidéo actuellement dans le lecteur. Le code qui traite de l' <code translate="No">Promise</code> est en surbrillance :</p>
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">var myPlayer = videojs.getPlayer('myPlayerID');
          myPlayer.on('loadedmetadata',function() {
            var promise = myPlayer.play();
            if (promise !== undefined) {
              <span class="bcls-highlight">promise.then(function() {
                // Autoplay started!
              }).catch(function(error) {
                // Autoplay was prevented.
              });</span>
            }
          });</code></pre>
    <p>Basé sur cela, vous pouvez alors coder les comportements si la vidéo jouée automatiquement ou non. Pour un cas d'utilisation spécifique de lecture de la vidéo, avec de l'audio lorsque c'est possible, reportez-vous à la section <a href="https://player.support.brightcove.com/playback/autoplay-considerations.html#Specific_use_case">Cas d'utilisation spécifique</a> du document <strong>Considérations de lecture automatique</strong>.</p>
    <p>Pour des informations complètes sur les promesses JavaScript, consultez le <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promesse MDN</a> document.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Promise_versus_callback"><code translate="No">Promise</code> par rapport au rappel</h2>
    <p>Dans cette section, la <code translate="No">get()</code> méthode du catalogue est utilisée pour démontrer la différence de syntaxe entre l'utilisation d'une <code translate="No">Promise</code> fonction de rappel et d'une fonction de rappel. La <code translate="No">get()</code> méthode peut être utilisée avec l'une ou l'autre des approches.</p>
    <h3>Syntaxe Promise</h3>
    <p>Voici un extrait de code montrant l'appel à la <code translate="No">get()</code> méthode, gérant la réponse comme <code translate="No">Promise</code>suit :</p>
    <pre class="line-numbers">
          <code class="language-javascript" translate="No">myPlayer.catalog.get(catalogParams).then(function(videosReturned){
            console.log('videosReturned',videosReturned);
            myPlayer.playlist(videosReturned);
          }).catch(function(errorObj){
            console.log('errorObj',errorObj);
          })</code></pre>
    <h3>Syntaxe de la fonction de rappel</h3>
    <p>Ce qui suit est un extrait de code montrant l'appel à la <code translate="No">get()</code> méthode, gérant la réponse avec une fonction de rappel :</p>
    <pre class="line-numbers">
            <code class="language-javascript" translate="No">myPlayer.catalog.get(catalogParams,function(errorObj,videosReturned){
            console.log('errorObj',errorObj);
            console.log('videosReturned',videosReturned);
            myPlayer.playlist(videosReturned);
          });
          </code></pre>
  </section>
</article>